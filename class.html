<!doctype html>
<html lang="vi" data-bs-theme="light">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>TẬP HUẤN XÂY DỰNG HỌC LIỆU SỐ CHO GIẢNG VIÊN, GIÁO VIÊN CÁC HỌC VIỆN, TRƯỜNG QUÂN ĐỘI</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
  <link rel="stylesheet" href="./style/style.css">
</head>
<body>
  <main>
    <section class="main class">
      <div class="container my-4">
        <div class="welcome">
          <img src="./images/tap-huan-tt.png" alt="welcome image" class="w-100" style="position: relative;">
        </div>

        <div class="information mb-3">
          <div class="content">
            <span>Thời gian:</span>
            <p>Từ ngày 25 đến 27/8/2025</p>
          </div>
          <div class="img-bottom"><img src="./images/bottom.webp" alt="image"></div>
        </div>

        <div class="information">
          <div class="content">
            <span>Địa điểm:</span>
            <p>Trung tâm Công nghệ thông tin và Ngoại ngữ, Trường Sĩ quan Thông tin</p>
          </div>
          <div class="img-bottom"><img src="./images/bottom.webp" alt="image"></div>
        </div>

        <!-- TIÊU ĐỀ -->
        <div class="title">
          <h1>Nhận tài liệu</h1>
        </div>

        <!-- FORM: Họ và tên + Nút Nhận tài liệu -->
        <div class="card shadow-sm mb-3">
          <div class="card-body">
            <form class="row gy-3 gx-2 align-items-end" onsubmit="return false;">
              <div class="col-12 col-md-8">
                <label for="hoten" class="form-label fw-semibold">Họ và tên <span class="text-danger">*</span></label>
                <input id="hoten" type="text" class="form-control" placeholder="Nhập họ tên (có/không dấu đều được)">
                <div class="form-text">Mẹo: gõ “Nguyen Van A” vẫn khớp “Nguyễn Văn A”.</div>
              </div>
              <div class="col-12 col-md-4 d-grid">
                <button id="btn" type="button" class="btn btn-primary">Nhận tài liệu</button>
              </div>
            </form>
            <div id="status" class="mt-3"></div>
          </div>
        </div>

        <!-- KẾT QUẢ: Trạng thái + Danh sách tài liệu -->
        <div id="result" class="card shadow-sm d-none">
          <div class="card-body" id="resultBody"></div>
        </div>
      </div>
    </section>

    <!-- Các block thông tin giữ nguyên layout -->
     <!-- CHƯƠNG TRÌNH TẬP HUẤN -->
<section id="agenda" style="max-width: 480px; margin: auto;">
  <div class="container my-4" >
 <header class="mb-3 text-center">
    <h2 class="mb-1">CHƯƠNG TRÌNH TẬP HUẤN</h2>
  </header>

  <div class="accordion" id="agendaAccordion">

    
    <!-- Thứ Hai 25/8/2025 -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="day1Heading">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#day1" aria-expanded="true" aria-controls="day1">
          Thứ Năm (11/9/2025)
        </button>
      </h2>
      <div id="day1" class="accordion-collapse collapse show" aria-labelledby="day1Heading" data-bs-parent="#agendaAccordion">
        <div class="accordion-body p-0">
          <div class="table-responsive">
            <table class="table table-striped table-bordered align-middle mb-0">
              <thead class="table-light">
                <tr>
                   <th class="text-center" style="width: 15%;">Thời gian</th>
                  <th class="text-center">Nội dung</th>
                  <th class="text-center" style="width: 30%;">Thực hiện</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-center">07:30 – 08:15</td>
                  <td>Khai mạc lớp tập huấn</td>
                  <td class="text-center">Ban Tổ chức</td>
                </tr>
                <tr>
                  <td class="text-center">08:30 – 11:30</td>
                  <td>
                    <p style="text-align: justify;margin-bottom: 10px;">- Giới thiệu chung về hệ thống tổ chức, chức năng, nhiệm vụ chuyên ngành KTTT toàn quân;</p>
                    <p style="text-align: justify;margin-bottom: 10px;">- Các nội dung cơ bản về bảo đảm trang bị thông tin, trọng tâm là phân nhóm, phân cấp chất lượng trang bị thông tin;</p>
                    <p style="text-align: justify;margin-bottom: 10px;">- Các nội dung chi tiết về bảo đảm kỹ thuật cho trang bị kỹ thuật thông tin</p>
                    <p style="text-align: justify;margin-bottom: 10px;">- Định hướng công tác nghiên cứu KHCN ngành TTLL trong giai đoạn 2026-2030; ứng dụng CNTT, chuyển đổi số trong công tác quản lý.</p>
                  </td>
                  <td class="text-center">Đ/c Trường -Trưởng phòng KTTT/Cục KTQBC</td>
                </tr>
                <tr>
                  <td class="text-center">13:30 – 16:30</td>
                  <td>
                    <p style="text-align: justify;margin-bottom: 10px;">- Công tác huấn luyện kỹ thuật thông tin;</p>
                    <p style="text-align: justify;margin-bottom: 10px;">- Công tác quản lý, xây dựng chính quy ngành và tham gia đối ngoại quân sự chuyên ngành KTTT; </p>
                    <p style="text-align: justify;margin-bottom: 10px;">- Công tác an toàn, vệ sinh lao động chuyên ngành KTTT;</p>
                    <p style="text-align: justify;margin-bottom: 10px;">- Công tác động viên kỹ thuật chuyên ngành KTTT.</p>
                  </td>
                  <td class="text-center">Đ/c Công - Phó Trưởng phòng KTTT/Cục KTQBC</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Thứ Ba 26/8/2025 -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="day2Heading">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#day2" aria-expanded="false" aria-controls="day2">
          Thứ Sáu (12/9/2025)
        </button>
      </h2>
      <div id="day2" class="accordion-collapse collapse" aria-labelledby="day2Heading" data-bs-parent="#agendaAccordion">
        <div class="accordion-body p-0">
          <div class="table-responsive">
            <table class="table table-striped table-bordered align-middle mb-0">
              <thead class="table-light">
                <tr>
                  <th class="text-center" style="width: 15%;">Thời gian</th>
                  <th class="text-center">Nội dung</th>
                  <th class="text-center" style="width: 30%;">Thực hiện</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-center">08:30 – 11:30</td>
                  <td>
                    <p style="text-align: justify;margin-bottom: 10px;">- Công tác BĐKT thông tin trong tác chiến: Nhiệm vụ, yêu cầu; nội dung BĐKT; tổ chức sử dụng, bố trí lực lượng kỹ thuật; bảo vệ kỹ thuật thông tin;</p>
                    <p style="text-align: justify;margin-bottom: 10px;">- Công tác kỹ thuật chuyên ngành kỹ thuật thông tin trong tác chiến phòng thủ quân khu, khu vực phòng thủ tỉnh, thành phố: Nội dung CTKT; tham gia xây dựng, điều chỉnh các KH kỹ thuật; xây dựng tiềm lực KTTT khu vực phòng thủ; tham gia xây dựng lực lượng kỹ thuật khu vực phòng thủ; xây dựng thế trận kỹ thuật thông tin khu vực phòng thủ.</p>
                  </td>
                  <td class="text-center">Đ/c Giảng viên – Khoa K7/HV KTQS</td>
                </tr>
                <tr>
                  <td class="text-center">13:30 – 16:30</td>
                  <td>
                    <p style="text-align: justify;margin-bottom: 10px;">- Bế mạc;</p>
                    <p style="text-align: justify;margin-bottom: 10px;">- Tham quan Trung tâm Công nghệ thông tin và Ngoại ngữ, Trường Sĩ quan Thông tin; Nhà Truyền thống Trường Sĩ quan Thông tin</p>
                  </td>
                  <td class="text-center">Ban Tổ chức</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

   

  </div>
  </div>
 
</section>

    

    <!-- <section class="contact py-4" style="max-width: 480px; margin: auto; text-align: center;">
      <div class="container">
        <a href="tel:0984577788" data-aos="flip-up" data-aos-duration="3000">SĐT Ban tổ chức: 0984577788</a>
      </div>
    </section> -->

    <footer style="max-width: 480px; margin: auto;">
      <div class="container">
        <div class="copyright"><span>© 2025 - Developed by Mitech Center</span></div>
      </div>
    </footer>
  </main>

  <!-- Bootstrap & AOS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
  <script> AOS.init(); </script>

  <!-- APP SCRIPT -->
  <script>
    // ======= CẤU HÌNH =======
    // Đổi thành URL /exec của Apps Script
    const GAS_URL = "https://script.google.com/macros/s/AKfycbzUxrrZYj5J7U-EP1R74Gf37XqBy9mG5yeF5J4TedgHrtU2q2oAVltvF_rUEiB3C3Efxw/exec";

    // ======= TIỆN ÍCH =======
    const $ = (id) => document.getElementById(id);
    const esc = (s) => String(s ?? "").replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
    const alertElem = (kind, html) => `<div class="alert alert-${kind} mb-0" role="alert">${html}</div>`;

    // JSONP để vượt CORS (Apps Script public)
    function jsonp(url){
      return new Promise((resolve, reject) => {
        const cb = "cb_mat_" + Date.now() + "_" + Math.random().toString(36).slice(2);
        window[cb] = (data) => { cleanup(); resolve(data); };
        function cleanup(){ try{ delete window[cb]; }catch(_){} s.remove(); }
        const s = document.createElement("script");
        s.src = url + (url.includes("?") ? "&" : "?") + "callback=" + cb;
        s.onerror = () => { cleanup(); reject(new Error("Network error")); };
        document.body.appendChild(s);
      });
    }

    // ======= RENDER KẾT QUẢ =======
    function renderMaterials(payload){
      const { name, status, materials = [], note, count } = payload || {};

      const badge = status === 'yes'
        ? `<span class="badge text-bg-success">yes</span>`
        : `<span class="badge text-bg-secondary">no</span>`;

      const tip = status === 'yes'
        ? `<div class="alert alert-success mt-2">Mời đồng chí tải tài liệu.</div>`
        : `<div class="alert alert-warning mt-2">Mời đồng chí tải tài liệu.</div>`;

      const list = materials.length
        ? `<ul class="list-group mt-3">
            ${materials.map((m,i)=>`
              <li class="list-group-item d-flex flex-wrap justify-content-between align-items-center gap-2">
                <span class="flex-grow-1">${esc(m.title || ('Tài liệu ' + (i+1)))}</span>
                <div class="d-flex gap-2">
                  <a class="btn btn-sm btn-outline-primary" target="_blank" rel="noopener" href="${esc(m.url)}">Xem</a>
                  <a class="btn btn-sm btn-primary" target="_blank" rel="noopener" href="${esc(m.downloadUrl || m.url)}">Tải xuống</a>
                </div>
              </li>
            `).join("")}
          </ul>`
        : `<div class="alert alert-secondary mt-3">Chưa có tài liệu trong thư mục.</div>`;

      const extra = note ? `<div class="text-secondary small mt-2">${esc(note)}</div>` : "";
      const countText = (typeof count === "number" ? count : materials.length) + " tệp";

      return `
        <div class="d-flex justify-content-between align-items-center mb-2">
          <div class="fw-semibold">Kết quả</div>
          <span class="badge text-bg-secondary">${countText}</span>
        </div>
        <div class="table-responsive">
          <table class="table table-bordered align-middle">
            <tbody>
              <tr>
                <th style="width: 120px;">Họ và tên</th>
                <td>${esc(name || "-")} ${badge}</td>
              </tr>
            </tbody>
          </table>
        </div>
        ${tip}
        ${list}
        ${extra}
      `;
    }

    // ======= TƯƠNG TÁC =======
    const btn = $("btn");
    const input = $("hoten");
    const status = $("status");
    const card = $("result");
    const cardBody = $("resultBody");

    function setLoading(on){
      if(on){
        btn.dataset.text = btn.innerHTML;
        btn.innerHTML = `<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>Đang xử lý…`;
        btn.disabled = true;
      }else{
        btn.innerHTML = btn.dataset.text || "Nhận tài liệu";
        btn.disabled = false;
      }
    }

    async function handleSubmit(){
      const name = input.value.trim();
      card.classList.add("d-none");
      cardBody.innerHTML = "";
      if(!name){
        status.innerHTML = alertElem("danger","Vui lòng nhập họ tên.");
        return;
      }
      status.innerHTML = "";
      setLoading(true);

      try{
        const url = `${GAS_URL}?action=materials&hoten=${encodeURIComponent(name)}&ua=${encodeURIComponent(navigator.userAgent)}&t=${Date.now()}`;
        const r = await jsonp(url);

        if(!r || r.ok !== true){
          status.innerHTML = alertElem("danger", esc(r && r.error ? r.error : "Không gọi được API"));
          return;
        }

        cardBody.innerHTML = renderMaterials(r);
        card.classList.remove("d-none");
      } catch(err){
        status.innerHTML = alertElem("danger", "Lỗi mạng: " + esc(err.message));
      } finally {
        setLoading(false);
      }
    }

    btn.addEventListener("click", handleSubmit);
    input.addEventListener("keydown", (e) => { if(e.key === "Enter") handleSubmit(); });

    // Prefill từ query ?name=... hoặc ?hoten=...
    (function prefill(){
      const q = new URLSearchParams(location.search);
      const v = q.get("name") || q.get("hoten");
      if(v){ input.value = v; }
    })();
  </script>
</body>
</html>
